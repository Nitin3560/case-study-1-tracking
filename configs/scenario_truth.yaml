sim:
  drone_model: "cf2x"
  physics: "pyb"
  gui: false
  freq_hz: 240
  ctrl_hz: 48
  duration_s: 40.0
  num_drones: 4
  seed: 1
  debug_obs: false

trajectory:
  type: "circle"
  radius_m: 8.0
  period_s: 18.0
  altitude_m: 2.0
  center_xy: [0.0, 0.0]

formation:
  type: "square"
  spacing_m: 2.0

disturbance:
  wind:
    mode: "phased"
    phases:
      - t0_s: 0.0
        t1_s: 10.0
        constant_force_n: [0.05, 0.0, 0.0]
        gust_force_n_max: 0.10
        gust_interval_s: [3.0, 6.0]
        gust_duration_s: [0.3, 0.8]

      - t0_s: 10.0
        t1_s: 25.0
        constant_force_n: [0.20, 0.00, 0.0]
        gust_force_n_max: 0.45
        gust_interval_s: [1.0, 2.5]
        gust_duration_s: [0.6, 1.4]

      - t0_s: 25.0
        t1_s: 40.0
        constant_force_n: [0.08, 0.00, 0.0]
        gust_force_n_max: 0.20
        gust_interval_s: [2.0, 4.0]
        gust_duration_s: [0.3, 0.8]

  gps_drift:
    enabled: false

metrics:
  steady_state_after_s: 25.0  # focus on recovery window for headline result

controllers:
  sensing:
    openloop: "truth"
    pid: "truth"
    agentic: "truth"

  pid:
    kp: 1.0
    kd: 0.6
    ki: 0.008
    v_max: 3.0

  # New supervisor keys used by src/controllers/pid_agentic.py
  agentic:
    # used by run_one.py to compute lookahead trajectory (p_ref at t+lookahead_s)
    lookahead_s: 0.5

    # supervisor behavior
    error_thresh_m: 1.2       # when agentic starts shaping the reference
    max_ref_shift_m: 0.8      # clamp on reference shift (meters)
    authority_alpha: 0.90     # smoothing for authority (higher = smoother / less twitchy)
